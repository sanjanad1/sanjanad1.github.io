{"backend_state":"init","connection_file":"/projects/4cd1c004-aa87-4c40-b1fd-5234fe1a4654/.local/share/jupyter/runtime/kernel-637bde63-0795-42ef-914e-d71bbc9af545.json","kernel":"ds_env","kernel_error":"","kernel_state":"idle","kernel_usage":{"cpu":0,"memory":0},"metadata":{"language_info":{"codemirror_mode":{"name":"ipython","version":3},"file_extension":".py","mimetype":"text/x-python","name":"python","nbconvert_exporter":"python","pygments_lexer":"ipython3","version":"3.8.13"}},"trust":true,"type":"settings"}
{"cell_type":"code","exec_count":0,"id":"d6b639","input":"","pos":8,"state":"done","type":"cell"}
{"cell_type":"code","exec_count":1,"id":"0dac84","input":"import numpy as np\nimport pandas as pd\nimport plotly.express as px\nfrom sklearn.model_selection import train_test_split\nimport tensorflow as tf","output":{"0":{"name":"stderr","output_type":"stream","text":"2022-06-22 15:18:48.163150: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcudart.so.11.0'; dlerror: libcudart.so.11.0: cannot open shared object file: No such file or directory\n2022-06-22 15:18:48.163193: I tensorflow/stream_executor/cuda/cudart_stub.cc:29] Ignore above cudart dlerror if you do not have a GPU set up on your machine.\n"}},"pos":0,"state":"done","type":"cell"}
{"cell_type":"code","exec_count":37,"id":"93a8f0","input":"df = pd.read_csv('../data/real_dataset.csv').sample(frac=0.005)\ndf.info()","output":{"0":{"name":"stdout","output_type":"stream","text":"<class 'pandas.core.frame.DataFrame'>\nInt64Index: 722 entries, 79835 to 116839\nData columns (total 26 columns):\n #   Column               Non-Null Count  Dtype  \n---  ------               --------------  -----  \n 0   playlist             722 non-null    object \n 1   danceability         722 non-null    float64\n 2   energy               722 non-null    float64\n 3   key                  722 non-null    float64\n 4   loudness             722 non-null    float64\n 5   speechiness          722 non-null    float64\n 6   acousticness         722 non-null    float64\n 7   instrumentalness     722 non-null    float64\n 8   liveness             722 non-null    float64\n 9   valence              722 non-null    float64\n 10  tempo                722 non-null    float64\n 11  duration_ms          722 non-null    float64\n 12  time_signature       722 non-null    float64\n 13  danceability_pl      722 non-null    float64\n 14  energy_pl            722 non-null    float64\n 15  key_pl               722 non-null    float64\n 16  loudness_pl          722 non-null    float64\n 17  speechiness_pl       722 non-null    float64\n 18  acousticness_pl      722 non-null    float64\n 19  instrumentalness_pl  722 non-null    float64\n 20  liveness_pl          722 non-null    float64\n 21  valence_pl           722 non-null    float64\n 22  tempo_pl             722 non-null    float64\n 23  duration_ms_pl       722 non-null    float64\n 24  time_signature_pl    722 non-null    float64\n 25  belongs              722 non-null    bool   \ndtypes: bool(1), float64(24), object(1)\nmemory usage: 147.4+ KB\n"}},"pos":1,"state":"done","type":"cell"}
{"cell_type":"code","exec_count":38,"id":"a33af9","input":"try:\n    y = pd.factorize(df['belongs'])[0]\n    df.drop(['belongs', 'playlist'], axis=1, inplace=True)\n    x_train, x_test, y_train, y_test = train_test_split(df, y, test_size=0.2)\nexcept KeyError:\n    x_train, x_test, y_train, y_test = train_test_split(df, y, test_size=0.2)","pos":2,"state":"done","type":"cell"}
{"cell_type":"code","exec_count":39,"id":"cd385c","input":"from sklearn.preprocessing import StandardScaler\n\nscaler = StandardScaler()\nx_train_scaled = scaler.fit_transform(x_train)\nx_test_scaled = scaler.transform(x_test)","pos":3,"state":"done","type":"cell"}
{"cell_type":"code","exec_count":40,"id":"bc3f6d","input":"model = tf.keras.Sequential()\nmodel.add(tf.keras.Input(shape=(24,)))\n# model.add(tf.keras.layers.Conv1D(12, 24, 1, input_shape = (None, 24), activation='relu'))\nmodel.add(tf.keras.layers.Dense(20, activation='relu'))\nmodel.add(tf.keras.layers.Dense(16, activation='relu'))\nmodel.add(tf.keras.layers.Dense(12, activation='relu'))\nmodel.add(tf.keras.layers.Dense(8, activation='relu'))\nmodel.add(tf.keras.layers.Dense(4, activation='relu'))\nmodel.add(tf.keras.layers.Dense(1, activation='sigmoid'))\n\n'''\ntf.keras.layers.Dropout(.2, input_shape=(24,))\nmodel.add(tf.keras.layers.Dense(16, activation='relu'))\ntf.keras.layers.Dropout(.2, input_shape=(16,))\nmodel.add(tf.keras.layers.Dense(8, activation='relu'))\ntf.keras.layers.Dropout(.2, input_shape=(8,))'''\n\nmodel.compile(\n    loss=tf.keras.losses.BinaryCrossentropy(from_logits=False),\n    optimizer=tf.keras.optimizers.Adam(learning_rate=0.15),\n    metrics=[\n        tf.keras.metrics.BinaryAccuracy(name='accuracy'),\n        tf.keras.metrics.Precision(name='precision'),\n        tf.keras.metrics.Recall(name='recall')\n    ]\n)","pos":4,"state":"done","type":"cell"}
{"cell_type":"code","exec_count":41,"id":"3661e7","input":"model.fit(x_train_scaled, y_train, epochs=4, batch_size=4)","output":{"0":{"name":"stdout","output_type":"stream","text":"Epoch 1/4\n"},"1":{"name":"stdout","output_type":"stream","text":"\r  1/145 [..............................] - ETA: 2:03 - loss: 0.7218 - accuracy: 0.5000 - precision: 1.0000 - recall: 0.3333"},"10":{"name":"stdout","output_type":"stream","text":"\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r 30/145 [=====>........................] - ETA: 0s - loss: 0.7143 - accuracy: 0.4667 - precision: 0.5000 - recall: 0.4375        "},"11":{"name":"stdout","output_type":"stream","text":"\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r 54/145 [==========>...................] - ETA: 0s - loss: 0.6994 - accuracy: 0.5231 - precision: 0.5592 - recall: 0.7025"},"12":{"name":"stdout","output_type":"stream","text":"\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r 82/145 [===============>..............] - ETA: 0s - loss: 0.7067 - accuracy: 0.4970 - precision: 0.5240 - recall: 0.6229"},"13":{"name":"stdout","output_type":"stream","text":"\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r111/145 [=====================>........] - ETA: 0s - loss: 0.7037 - accuracy: 0.4932 - precision: 0.5132 - recall: 0.5065"},"14":{"name":"stdout","output_type":"stream","text":"\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r139/145 [===========================>..] - ETA: 0s - loss: 0.7028 - accuracy: 0.4892 - precision: 0.5115 - recall: 0.4586"},"15":{"name":"stdout","output_type":"stream","text":"\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r145/145 [==============================] - 0s 2ms/step - loss: 0.7021 - accuracy: 0.4922 - precision: 0.5160 - recall: 0.4801\n"},"16":{"name":"stdout","output_type":"stream","text":"Epoch 3/4\n"},"17":{"name":"stdout","output_type":"stream","text":"\r  1/145 [..............................] - ETA: 0s - loss: 0.5293 - accuracy: 1.0000 - precision: 1.0000 - recall: 1.0000"},"18":{"name":"stdout","output_type":"stream","text":"\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r 29/145 [=====>........................] - ETA: 0s - loss: 0.6950 - accuracy: 0.5603 - precision: 0.5603 - recall: 1.0000"},"19":{"name":"stdout","output_type":"stream","text":"\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r 53/145 [=========>....................] - ETA: 0s - loss: 0.6984 - accuracy: 0.5142 - precision: 0.5221 - recall: 0.6514"},"2":{"name":"stdout","output_type":"stream","text":"\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r 27/145 [====>.........................] - ETA: 0s - loss: 0.7110 - accuracy: 0.5370 - precision: 0.5464 - recall: 0.8983  "},"20":{"name":"stdout","output_type":"stream","text":"\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r 81/145 [===============>..............] - ETA: 0s - loss: 0.7004 - accuracy: 0.5031 - precision: 0.5216 - recall: 0.7076"},"21":{"name":"stdout","output_type":"stream","text":"\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r108/145 [=====================>........] - ETA: 0s - loss: 0.6993 - accuracy: 0.4931 - precision: 0.5107 - recall: 0.6356"},"22":{"name":"stdout","output_type":"stream","text":"\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r136/145 [===========================>..] - ETA: 0s - loss: 0.6989 - accuracy: 0.5074 - precision: 0.5255 - recall: 0.7153"},"23":{"name":"stdout","output_type":"stream","text":"\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r145/145 [==============================] - 0s 2ms/step - loss: 0.6989 - accuracy: 0.5043 - precision: 0.5196 - recall: 0.7020\n"},"24":{"name":"stdout","output_type":"stream","text":"Epoch 4/4\n"},"25":{"name":"stdout","output_type":"stream","text":"\r  1/145 [..............................] - ETA: 0s - loss: 0.7249 - accuracy: 0.2500 - precision: 0.0000e+00 - recall: 0.0000e+00"},"26":{"name":"stdout","output_type":"stream","text":"\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r 24/145 [===>..........................] - ETA: 0s - loss: 0.6886 - accuracy: 0.5625 - precision: 0.0000e+00 - recall: 0.0000e+00"},"27":{"name":"stdout","output_type":"stream","text":"\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r 51/145 [=========>....................] - ETA: 0s - loss: 0.6919 - accuracy: 0.5392 - precision: 0.5000 - recall: 0.0851        "},"28":{"name":"stdout","output_type":"stream","text":"\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r 75/145 [==============>...............] - ETA: 0s - loss: 0.6926 - accuracy: 0.5333 - precision: 0.5179 - recall: 0.4028"},"29":{"name":"stdout","output_type":"stream","text":"\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r105/145 [====================>.........] - ETA: 0s - loss: 0.6908 - accuracy: 0.5476 - precision: 0.5517 - recall: 0.5981"},"3":{"name":"stdout","output_type":"stream","text":"\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r 55/145 [==========>...................] - ETA: 0s - loss: 0.7108 - accuracy: 0.5136 - precision: 0.5620 - recall: 0.6210"},"30":{"name":"stdout","output_type":"stream","text":"\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r135/145 [==========================>...] - ETA: 0s - loss: 0.6930 - accuracy: 0.5296 - precision: 0.5428 - recall: 0.5893"},"31":{"name":"stdout","output_type":"stream","text":"\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r145/145 [==============================] - 0s 2ms/step - loss: 0.6919 - accuracy: 0.5338 - precision: 0.5484 - recall: 0.6192\n"},"32":{"data":{"text/plain":"<keras.callbacks.History at 0x7fb516917ac0>"},"exec_count":41,"output_type":"execute_result"},"4":{"name":"stdout","output_type":"stream","text":"\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r 79/145 [===============>..............] - ETA: 0s - loss: 0.7144 - accuracy: 0.5000 - precision: 0.5446 - recall: 0.6554"},"5":{"name":"stdout","output_type":"stream","text":"\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r105/145 [====================>.........] - ETA: 0s - loss: 0.7112 - accuracy: 0.5048 - precision: 0.5363 - recall: 0.7359"},"6":{"name":"stdout","output_type":"stream","text":"\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r133/145 [==========================>...] - ETA: 0s - loss: 0.7061 - accuracy: 0.5113 - precision: 0.5315 - recall: 0.6855"},"7":{"name":"stdout","output_type":"stream","text":"\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r145/145 [==============================] - 1s 2ms/step - loss: 0.7043 - accuracy: 0.5165 - precision: 0.5315 - recall: 0.6424\n"},"8":{"name":"stdout","output_type":"stream","text":"Epoch 2/4\n"},"9":{"name":"stdout","output_type":"stream","text":"\r  1/145 [..............................] - ETA: 0s - loss: 0.7161 - accuracy: 0.5000 - precision: 0.0000e+00 - recall: 0.0000e+00"}},"pos":5,"scrolled":true,"state":"done","type":"cell"}
{"cell_type":"code","exec_count":44,"id":"7247de","input":"test_predictions = model.predict_on_batch(x_test_scaled)\n#test_predictions = test_predictions.flatten()\n# print(test_predictions)\nprediction_classes = [\n    0 if prob > 0.5 else 1 for prob in np.ravel(test_predictions)\n]\nprint(prediction_classes[:50])","output":{"0":{"name":"stdout","output_type":"stream","text":"[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]\n"}},"pos":6,"state":"done","type":"cell"}
{"cell_type":"code","exec_count":45,"id":"305e50","input":"from sklearn.metrics import accuracy_score\n\naccuracy_score(prediction_classes, y_test)","output":{"0":{"data":{"text/plain":"0.5310344827586206"},"exec_count":45,"output_type":"execute_result"}},"pos":7,"state":"done","type":"cell"}
{"id":0,"time":1655997972533,"type":"user"}
{"last_load":1655994097831,"type":"file"}